<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Cryptic Crossword — Memorials</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<style>
:root{ --size:36px; --gap:2px; --bg:#0a0a0f; --ink:#e7e9ee; --muted:#9aa1ad; --accent:#00ff9f; --block:#000; --cell:#fff; --border:#2a2f3a; }
*{box-sizing:border-box}
body{margin:0; padding:24px; background:var(--bg); color:var(--ink); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;}
h1{font-size:20px;margin:0 0 12px}
.wrapper{display:grid; grid-template-columns: 1fr 320px; gap:24px; align-items:start;}
@media (max-width:900px){ .wrapper{grid-template-columns:1fr;} }
.grid{display:grid; grid-template-columns: repeat(40, var(--size)); gap: var(--gap); width: fit-content; border:1px solid var(--border); padding: var(--gap); background:#0f1118; border-radius:10px; box-shadow: 0 0 0 1px rgba(255,255,255,0.03) inset, 0 20px 50px rgba(0,0,0,0.4);}
.cell{width:var(--size); height:var(--size); background:var(--cell); position:relative; border-radius:6px; overflow:hidden; display:flex; align-items:center; justify-content:center; box-shadow: inset 0 0 0 1px #cfd3dc;}
.cell.block{ background:var(--block); box-shadow: inset 0 0 0 1px #000; }
.cell input{width:100%; height:100%; background: transparent; color:#000; text-transform: uppercase; font-weight:800; font-size:18px; text-align:center; border:none; outline:none; border-radius:6px; caret-color: var(--accent);}
.cell input:focus{ box-shadow: inset 0 0 0 2px rgba(0,255,159,0.45);}
.num{position:absolute; top:2px; left:4px; font-size:10px; color:#111; font-weight:700; pointer-events:none;}
.controls{display:flex; gap:12px; align-items:center; margin:8px 0 16px}
.buttons button{ background:#141821; color:#e9f0ff; border:1px solid #2c3443; padding:8px 12px; border-radius:8px; cursor:pointer; }
.buttons button:hover{ border-color: var(--accent); }
.panel{position:sticky; top:16px; border:1px solid #2a2f3a; border-radius:10px; padding:12px; background:#0f1118; box-shadow: 0 0 0 1px rgba(255,255,255,0.03) inset;}
.panel h2{font-size:16px;margin:0 0 8px}
.panel h3{font-size:14px;margin:12px 0 6px; color:#c3c8d6}
.clues{display:flex; flex-direction:column; gap:6px;}
.clue{padding:6px 8px; border:1px solid transparent; border-radius:8px; cursor:pointer; line-height:1.2}
.clue:hover{ border-color:#2c3443; background:#111522; }
.clue.active{ border-color: var(--accent); background: rgba(0,255,159,0.08);}
.highlight input{ box-shadow: inset 0 0 0 2px rgba(0,255,159,0.65) !important;}
.note{color:var(--muted); font-size: 12px; margin-top:8px}

/* Gold glow when puzzle is fully completed */
.cell.gold { box-shadow: 0 0 0 2px #ffcc33, 0 0 14px #ffcc33 !important; }
.cell.gold input { background: #fff6d5 !important; box-shadow: inset 0 0 0 2px #ffcc33 !important; }
</style>
</head>
<body>
<h1>Cryptic Crossword — Memorials</h1>
<div class="controls">
  <div class="buttons">
    <button id="btn-clear">Clear</button>
    <button id="btn-check">Check</button>
    <button id="btn-save">Export Progress</button>
    <button id="btn-load">Import Progress</button>
  </div>
  <div class="note">The path will be illuminated to your destintion.</div>
</div>
<div class="wrapper">
  <div class="grid" id="grid"></div>
  <aside class="panel">
    <h2>Clues</h2>
    <h3>Across</h3>
    <div class="clues" id="across"></div>
    <h3>Down</h3>
    <div class="clues" id="down"></div>
  </aside>
</div>

<script>
/* ------------------ DATA (unchanged) ------------------ */
const GRID = [[{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "V"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "O"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "L"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "T"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "K"}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "A"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "I"}, {"blocked": false, "solution": "C"}, {"blocked": false, "solution": "I"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "N"}, {"blocked": false, "solution": "H"}, {"blocked": false, "solution": "R"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "G"}, {"blocked": false, "solution": "U"}, {"blocked": false, "solution": "E"}, {"blocked": false, "solution": "V"}, {"blocked": false, "solution": "A"}, {"blocked": false, "solution": "R"}, {"blocked": false, "solution": "A"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "J"}, {"blocked": false, "solution": "R"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "M"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "R"}, {"blocked": false, "solution": "C"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "G"}, {"blocked": false, "solution": "A"}, {"blocked": false, "solution": "N"}, {"blocked": false, "solution": "D"}, {"blocked": false, "solution": "H"}, {"blocked": false, "solution": "I"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "H"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "N"}, {"blocked": false, "solution": "G"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "J"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "I"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "F"}, {"blocked": false, "solution": "D"}, {"blocked": false, "solution": "R"}, {"blocked": false, "solution": "O"}, {"blocked": false, "solution": "O"}, {"blocked": false, "solution": "S"}, {"blocked": false, "solution": "E"}, {"blocked": false, "solution": "V"}, {"blocked": false, "solution": "E"}, {"blocked": false, "solution": "L"}, {"blocked": false, "solution": "T"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "E"}, {"blocked": false, "solution": "A"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "F"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "L"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "L"}, {"blocked": false, "solution": "N"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "F"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "A"}, {"blocked": false, "solution": "T"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "E"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "R"}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "L"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "W"}, {"blocked": false, "solution": "A"}, {"blocked": false, "solution": "S"}, {"blocked": false, "solution": "H"}, {"blocked": false, "solution": "I"}, {"blocked": false, "solution": "N"}, {"blocked": false, "solution": "G"}, {"blocked": false, "solution": "T"}, {"blocked": false, "solution": "O"}, {"blocked": false, "solution": "N"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "O"}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "N"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "N"}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "C"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "O"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "L"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], [{"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": false, "solution": "N"}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}, {"blocked": true, "solution": ""}], /* ... remaining rows unchanged ... */];
/* NOTE: The GRID above is long; keep all remaining rows exactly as in your file */

const NUMBERS = [["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""], ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""], ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""], ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "4", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""], /* ... keep the rest of NUMBERS exactly as in your file ... */];

const ACROSS = [{"num": 1, "cells": [[10, 14], [10, 15], [10, 16], [10, 17], [10, 18], [10, 19], [10, 20]], "answer": "GUEVARA"}, {"num": 2, "cells": [[13, 6], [13, 7], [13, 8], [13, 9], [13, 10], [13, 11]], "answer": "GANDHI"}, {"num": 3, "cells": [[20, 10], [20, 11], [20, 12], [20, 13], [20, 14], [20, 15], [20, 16], [20, 17], [20, 18], [20, 19]], "answer": "WASHINGTON"}];
const DOWN = [{"num": 4, "cells": [[3, 16], [4, 16], [5, 16], [6, 16], [7, 16], [8, 16], [9, 16], [10, 16]], "answer": "VOLTAIRE"}, {"num": 5, "cells": [[7, 14], [8, 14], [9, 14], [10, 14], [11, 14], [12, 14]], "answer": "KINGJR"}, {"num": 6, "cells": [[8, 15], [9, 15], [10, 15], [11, 15], [12, 15], [13, 15], [14, 15], [15, 15], [16, 15]], "answer": "CHURCHILL"}, {"num": 7, "cells": [[12, 7], [13, 7], [14, 7], [15, 7], [16, 7], [17, 7], [18, 7]], "answer": "MANDELA"}, {"num": 8, "cells": [[14, 12], [15, 12], [16, 12], [17, 12], [18, 12], [19, 12], [20, 12], [21, 12], [22, 12]], "answer": "JEFFERSON"}, {"num": 9, "cells": [[19, 14], [20, 14], [21, 14], [22, 14], [23, 14], [24, 14], [25, 14]], "answer": "LINCOLN"}];
const CLUES = {"WASHINGTON": "First leader crossing the Delaware, standing tall in stone", "JEFFERSON": "Author of independence, remembered by a domed memorial", "LINCOLN": "Freed the enslaved, seated forever on the National Mall", "ROOSEVELT": "Four freedoms, wheelchair, and fireside resolve", "GRANT": "Civil War general honored on horseback by the Capitol", "FDR": "New Deal initials, memorial by the Tidal Basin", "MANDELA": "From prisoner to president of freedom in South Africa", "GANDHI": "Led independence through non-violence and salt marches", "CHURCHILL": "‘We shall never surrender’—wartime PM cast in bronze", "GUEVARA": "Cuban revolutionary, iconic mural face", "KINGJR": "Dreamer whose memorial looks toward Lincoln", "VOLTAIRE": "Enlightenment wit resting in Paris’s Panthéon"};

/* --------- NEW: derive dimensions & safe label accessor --------- */
const ROWS = Array.isArray(GRID) ? GRID.length : 0;
const COLS = ROWS && Array.isArray(GRID[0]) ? GRID[0].length : 0;

function getNumberLabel(r, c){
  return (Array.isArray(NUMBERS) && NUMBERS[r] && typeof NUMBERS[r][c] !== 'undefined')
    ? NUMBERS[r][c]
    : "";
}

/* ------------------ UI/logic (unchanged except buildGrid) ------------------ */
const gridEl = document.getElementById('grid');

function idFor(r,c){ return `r${r}c${c}`; }

/* --------- NEW: safer buildGrid --------- */
function buildGrid(){
  if(!Array.isArray(GRID) || !ROWS || !COLS){
    console.error('GRID missing or malformed.');
    return;
  }
  gridEl.innerHTML = '';

  for(let r=0; r<ROWS; r++){
    const row = GRID[r];
    if(!Array.isArray(row)){
      console.warn('Missing GRID row at', r);
      continue;
    }
    for(let c=0; c<COLS; c++){
      const cell = row[c] || { blocked: true, solution: "" };

      const div = document.createElement('div');
      div.className = 'cell' + (cell.blocked ? ' block' : '');

      if(!cell.blocked){
        const numTxt = getNumberLabel(r, c);
        if(numTxt){
          const n = document.createElement('div');
          n.className='num';
          n.textContent = numTxt;
          div.appendChild(n);
        }
        const inp = document.createElement('input');
        inp.setAttribute('maxlength','1');
        inp.dataset.r = r; inp.dataset.c = c;
        inp.id = idFor(r,c);
        inp.addEventListener('input', (e)=>{
          e.target.value = e.target.value.toUpperCase().replace(/[^A-Z]/g,'');
        });
        inp.addEventListener('keydown', (e)=>{
          if(e.key === 'ArrowLeft'){ e.preventDefault(); move(r,c,0,-1); }
          else if(e.key === 'ArrowRight'){ e.preventDefault(); move(r,c,0,1); }
          else if(e.key === 'ArrowUp'){ e.preventDefault(); move(r,c,-1,0); }
          else if(e.key === 'ArrowDown'){ e.preventDefault(); move(r,c,1,0); }
          else if(e.key === 'Backspace'){
            if(!e.target.value){ e.preventDefault(); move(r,c,0,-1,true); }
            else { e.target.value=''; e.preventDefault(); }
          }
        });
        div.appendChild(inp);
      }
      gridEl.appendChild(div);
    }
  }
}

function move(r,c,dr,dc,clearPrev=false){
  let nr=r, nc=c;
  while(true){
    nr += dr; nc += dc;
    if(nr<0||nc<0||nr>=ROWS||nc>=COLS) return;
    if(!GRID[nr][nc].blocked){
      const el = document.getElementById(idFor(nr,nc));
      if(el){
        el.focus();
        if(clearPrev) el.value='';
      }
      return;
    }
  }
}

function clearAll(){
  document.querySelectorAll('.cell input').forEach(i=> i.value='');
}

function checkAll(){
  let correct=0, total=0;
  document.querySelectorAll('.cell input').forEach(inp=>{
    const r = +inp.dataset.r, c = +inp.dataset.c;
    const want = (GRID[r][c].solution || '').toUpperCase();
    const got = (inp.value||'').toUpperCase();
    if(want){
      total++;
      inp.style.boxShadow = (got===want) ? 'inset 0 0 0 2px #1dd881' : 'inset 0 0 0 2px #ff4d6d';
    } else {
      inp.style.boxShadow = 'inset 0 0 0 1px #cfd3dc';
    }
    if(got===want && want) correct++;
  });
  const pct = total ? Math.round(100*correct/total) : 0;
  alert(`Checked: ${correct}/${total} letters correct (${pct}%).`);
}

function renderClues(){
  const acrossEl = document.getElementById('across');
  const downEl = document.getElementById('down');
  const makeClue = (entry, dir)=>{
    const ans = (entry.answer||'').toUpperCase();
    const clueText = CLUES[ans] || `Clue for ${ans||'(unknown)'}`;
    const div = document.createElement('div');
    div.className = 'clue';
    div.dataset.dir = dir;
    div.dataset.num = entry.num;
    const len = entry.cells.length;
    div.textContent = `${entry.num}. ${clueText} (${len})`;
    div.addEventListener('click', ()=> highlightEntry(entry, dir, div));
    return div;
  };
  ACROSS.forEach(e=> acrossEl.appendChild(makeClue(e,'A')));
  DOWN.forEach(e=> downEl.appendChild(makeClue(e,'D')));
}

let activeCells = [];
function highlightEntry(entry, dir, clueEl){
  activeCells.forEach(([r,c])=>{
    const el = document.getElementById(idFor(r,c));
    if(el) el.parentElement.classList.remove('highlight');
  });
  document.querySelectorAll('.clue').forEach(el=> el.classList.remove('active'));
  clueEl.classList.add('active');
  activeCells = entry.cells;
  entry.cells.forEach(([r,c])=>{
    const el = document.getElementById(idFor(r,c));
    if(el) el.parentElement.classList.add('highlight');
  });
  if(entry.cells.length){
    const [r,c] = entry.cells[0];
    const el = document.getElementById(idFor(r,c));
    if(el) el.focus();
  }
}

document.getElementById('btn-clear').addEventListener('click', clearAll);
document.getElementById('btn-check').addEventListener('click', checkAll);
document.getElementById('btn-save').addEventListener('click', ()=>{
  const data=[];
  document.querySelectorAll('.cell input').forEach(inp=>{
    data.push({r:+inp.dataset.r, c:+inp.dataset.c, v:(inp.value||'').toUpperCase()});
  });
  const blob = new Blob([JSON.stringify({rows:ROWS, cols:COLS, data}, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'crossword_progress.json'; a.click();
  URL.revokeObjectURL(url);
});
document.getElementById('btn-load').addEventListener('click', ()=>{
  const inp = document.createElement('input');
  inp.type = 'file'; inp.accept = 'application/json';
  inp.addEventListener('change', ()=>{
    const f = inp.files[0];
    const reader = new FileReader();
    reader.onload = ()=>{ try{ 
      const obj = JSON.parse(reader.result);
      obj.data.forEach(o=>{
        const el = document.getElementById(idFor(o.r,o.c));
        if(el) el.value = (o.v||'').toUpperCase();
      });
    }catch(err){ alert('Import failed: ' + err.message); } };
    reader.readAsText(f);
  });
  inp.click();
});

/* Run once DOM is ready (safe even if script stays at bottom) */
document.addEventListener('DOMContentLoaded', () => {
  buildGrid();
  renderClues();
});

/* --- Gold glow logic for JEFFERSON when the crossword is fully correct (unchanged) --- */
(function(){
  function idFor(r,c){ return 'r'+r+'c'+c; }
  function isPuzzleComplete(){
    try{
      for(let r=0;r<ROWS;r++){
        for(let c=0;c<COLS;c++){
          const want = (GRID[r][c].solution||'').toUpperCase();
          if(!GRID[r][c].blocked){
            const el = document.getElementById(idFor(r,c));
            const got = (el && el.value ? el.value.toUpperCase() : '');
            if(got !== want) return false;
          }
        }
      }
      return true;
    }catch(e){
      return false;
    }
  }
  function getJeffersonCells(){
    const entries = [];
    if (typeof ACROSS !== 'undefined' && Array.isArray(ACROSS)) entries.push(...ACROSS);
    if (typeof DOWN   !== 'undefined' && Array.isArray(DOWN))   entries.push(...DOWN);
    for(const e of entries){
      const ans = (e.answer||'').toUpperCase();
      if(ans === 'JEFFERSON'){
        return Array.isArray(e.cells) ? e.cells : [];
      }
    }
    const target = 'JEFFERSON';
    for(let c=0;c<COLS;c++){
      for(let r=0;r<ROWS;r++){
        if(r>0 && !GRID[r-1][c].blocked) continue;
        let ok=true, cells=[];
        for(let i=0;i<target.length;i++){
          const rr=r+i;
          if(rr>=ROWS || GRID[rr][c].blocked || (GRID[rr][c].solution||'').toUpperCase()!==target[i]) { ok=false; break; }
          cells.push([rr,c]);
        }
        if(ok) return cells;
      }
    }
    return [];
  }
  const jeffCells = getJeffersonCells();
  function setGold(on){
    jeffCells.forEach(([r,c])=>{
      const el = document.getElementById(idFor(r,c));
      if(el){ 
        const tile = el.parentElement;
        if(tile){
          if(on) tile.classList.add('gold');
          else tile.classList.remove('gold');
        }
      }
    });
  }
  function checkAndGlow(){
    const complete = isPuzzleComplete();
    setGold(complete);
  }
  document.addEventListener('input', function(e){
    if(e.target && e.target.tagName === 'INPUT'){
      setTimeout(checkAndGlow, 0);
    }
  }, true);
  var btnCheck = document.getElementById('btn-check');
  if(btnCheck){
    btnCheck.addEventListener('click', function(){ setTimeout(checkAndGlow, 0); });
  }
  setGold(false);
})();
</script>
</body>
</html>
